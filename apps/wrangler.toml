name = "dogan-ai-platform"
main = "src/cloudflare-worker.ts"
compatibility_date = "2024-01-01"
node_compat = true

# Account Info
account_id = "66b51ac969911d4364f483d887a66c0f"
workers_dev = true

# Routes
routes = [
  { pattern = "dogan-ai.com/api/*", zone_name = "dogan-ai.com" },
  { pattern = "www.dogan-ai.com/api/*", zone_name = "dogan-ai.com" }
]

# Cloudflare Workers AI
[ai]
binding = "AI"

# Cloudflare Vectorize
[[vectorize]]
binding = "VECTORIZE_PRODUCTS"
index_name = "dogan-ai-products"

[[vectorize]]
binding = "VECTORIZE_DOCUMENTS"
index_name = "dogan-ai-documents"

[[vectorize]]
binding = "VECTORIZE_SUPPORT"
index_name = "dogan-ai-support"

[[vectorize]]
binding = "VECTORIZE_GRC"
index_name = "dogan-ai-grc"

# Cloudflare D1 Database
[[d1_databases]]
binding = "DB"
database_name = "dogan-ai-db"
database_id = "dogan-ai-production-db"

# KV Namespaces for caching
[[kv_namespaces]]
binding = "CACHE"
id = "dogan-ai-cache-kv"
preview_id = "dogan-ai-cache-preview"

[[kv_namespaces]]
binding = "SESSIONS"
id = "your-sessions-kv-id"
preview_id = "your-preview-sessions-kv-id"

[[kv_namespaces]]
binding = "ANALYTICS"
id = "your-analytics-kv-id"
preview_id = "your-preview-analytics-kv-id"

# R2 Buckets for file storage
[[r2_buckets]]
binding = "STORAGE"
bucket_name = "dogan-ai-files"
preview_bucket_name = "dogan-ai-files-preview"

[[r2_buckets]]
binding = "REPORTS"
bucket_name = "dogan-ai-reports"
preview_bucket_name = "dogan-ai-reports-preview"

# Durable Objects for real-time features
[[durable_objects.bindings]]
name = "WEBSOCKET"
class_name = "WebSocketDurableObject"
script_name = "saudi-store-ai"

[[migrations]]
tag = "v1"
new_classes = ["WebSocketDurableObject"]

# Environment Variables
[vars]
ENVIRONMENT = "production"
APP_NAME = "Dogan AI - GRC Platform"
APP_URL = "https://dogan-ai.com"
R2_ENDPOINT = "https://66b51ac969911d4364f483d887a66c0f.r2.cloudflarestorage.com"
R2_ACCOUNT_ID = "66b51ac969911d4364f483d887a66c0f"

# Cron Triggers - Keep AI Active
[triggers]
crons = [
  "*/5 * * * *"  # Every 5 minutes - Keep AI warm
]

# Limits
[limits]
cpu_ms = 50000  # 50 seconds

# Build
[build]
command = "npm run build:worker"

# Development
[env.development]
vars = { ENVIRONMENT = "development" }

[env.development.ai]
binding = "AI"

# Staging
[env.staging]
vars = { ENVIRONMENT = "staging" }
route = { pattern = "staging.saudi-store.yourdomain.com/api/ai/*", zone_name = "yourdomain.com" }

# Production
[env.production]
vars = { ENVIRONMENT = "production" }
route = { pattern = "saudi-store.yourdomain.com/api/ai/*", zone_name = "yourdomain.com" }

# Secrets (use: wrangler secret put SECRET_NAME)
# OPENAI_API_KEY
# ANTHROPIC_API_KEY
# GOOGLE_AI_API_KEY
# TOGETHER_AI_API_KEY
# MISTRAL_API_KEY
# COHERE_API_KEY
# HUGGINGFACE_API_KEY
# AZURE_OPENAI_API_KEY
# AZURE_OPENAI_ENDPOINT
# JWT_SECRET
# DATABASE_URL
